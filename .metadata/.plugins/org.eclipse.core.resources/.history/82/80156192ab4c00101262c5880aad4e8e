#include "AP_main.h"

void delay_while(int);

uint32_t count_watcher(uint32_t* count);
void LedBarShift(uint32_t *data, uint32_t ShiftMode);
void ButtonPush(uint32_t btn, uint32_t* pre, uint32_t* mode);
void ButtonRelease(uint32_t btn, uint32_t* pre, uint32_t* mode);
void Event(uint32_t*);

int main(void)
{
	ap_init();

}

uint32_t count_watcher(uint32_t* count){
	if(*count == 10000) {
		*count=0;
		return 1;
	}
	return 0;
}

void LedBarShift(uint32_t *data, uint32_t ShiftMode){
	LedBar_Write(*data);
	switch (ShiftMode) {
	case 0:
		*data = (*data<<1)|(*data>>7);
		break;
	case 1:
		*data = (*data>>1)|(*data<<7);
	}
}

void ButtonPush(uint32_t btn, uint32_t* pre, uint32_t* mode){
	if(btn == 0) {
		if(*pre == 1) Event(mode);
		*pre = btn;
	}
}

void ButtonRelease(uint32_t btn, uint32_t* pre, uint32_t* mode){
	if(btn == 1) {
		//		if(*pre == 0) Event(mode);
		*pre = btn;
	}
}

void Event(uint32_t* mode){
	(*mode) = (*mode) ? 0 : 1;
}

void delay_while(int time){
	for (int i = 0; i < time; ++i);
}
